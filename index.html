<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/x-icon" href="https://static.vecteezy.com/system/resources/previews/007/201/784/non_2x/ecr-letter-logo-design-on-black-background-ecr-creative-initials-letter-logo-concept-ecr-letter-design-vector.jpg">
    <title>EcrMaker</title>
    <style>
        :root {
            --bg-light: #f5f5f7;
            --text-light: #1d1d1f;
            --bg-dark: #1C1C1E;
            --text-dark: #f5f5f7;
            --accent: #007AFF;
            --drk-accent: #6e6e6e1a;
            --border-light: #d2d2d7;
            --border-dark: #333
        }

        #drop-zone,
        body,
        header,
        main {
            display: flex
        }

        .faq-question,
        .faq-title,
        .feature-title,
        .features-title,
        .logo,
        h1 {
            font-weight: 600
        }

        .features-title,
        .update-banner,
        footer,
        main {
            text-align: center
        }

        .dark-mode .changelog-changes,
        .dark-mode .changelog-date,
        .dark-mode .faq-answer,
        .dark-mode .faq-question,
        .dark-mode .faq-title,
        .dark-mode .feature-desc,
        .dark-mode .feature-title,
        .dark-mode .features-title,
        .dark-mode .footer-copyright,
        .dark-mode .footer-link,
        .update-banner a,
        body.dark-mode {
            color: var(--text-dark)
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: var(--bg-light);
            color: var(--text-light);
            line-height: 1.5;
            transition: .3s;
            min-height: 100vh;
            flex-direction: column
        }

        body.dark-mode {
            background-color: var(--bg-dark)
        }

        .update-banner {
            background-color: var(--accent);
            color: #fff;
            padding: 8px;
            font-size: 14px
        }

        header {
            height: 60px;
            padding: 0 5%;
            position: sticky;
            top: 0;
            backdrop-filter: blur(10px);
            background-color: rgba(245, 245, 247, .8);
            z-index: 100;
            align-items: center;
            justify-content: space-between
        }

        .dark-mode header {
            background-color: rgba(28, 28, 30, .5)
        }

        .dark-mode .update-banner,
        .dark-mode footer {
            background-color: var(--drk-accent)
        }

        .logo {
            font-size: 20px;
            letter-spacing: -.01em
        }

        #drop-zone p,
        .convert-btn {
            font-size: clamp(15px, 3vw, 17px)
        }

        .toggle-mode {
            width: 24px;
            height: 24px;
            background: currentColor;
            border: none;
            cursor: pointer;
            padding: 0;
            opacity: .7;
            transition: opacity .3s;
            -webkit-mask: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke-width='1.5' stroke='currentColor'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' d='M21.752 15.002A9.72 9.72 0 0 1 18 15.75c-5.385 0-9.75-4.365-9.75-9.75 0-1.33.266-2.597.748-3.752A9.753 9.753 0 0 0 3 11.25C3 16.635 7.365 21 12.75 21a9.753 9.753 0 0 0 9.002-5.998Z'/%3E%3C/svg%3E") center/contain no-repeat;
            mask: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke-width='1.5' stroke='currentColor'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' d='M21.752 15.002A9.72 9.72 0 0 1 18 15.75c-5.385 0-9.75-4.365-9.75-9.75 0-1.33.266-2.597.748-3.752A9.753 9.753 0 0 0 3 11.25C3 16.635 7.365 21 12.75 21a9.753 9.753 0 0 0 9.002-5.998Z'/%3E%3C/svg%3E") center/contain no-repeat
        }

        #drop-zone,
        .convert-btn {
            cursor: pointer;
            transition: .3s
        }

        .dark-mode .toggle-mode {
            background-color: var(--bg-light);
            -webkit-mask: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke-width='1.5' stroke='currentColor'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' d='M12 3v2.25m6.364.386-1.591 1.591M21 12h-2.25m-.386 6.364-1.591-1.591M12 18.75V21m-4.773-4.227-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0Z'/%3E%3C/svg%3E") center/contain no-repeat;
            mask: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke-width='1.5' stroke='currentColor'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' d='M12 3v2.25m6.364.386-1.591 1.591M21 12h-2.25m-.386 6.364-1.591-1.591M12 18.75V21m-4.773-4.227-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0Z'/%3E%3C/svg%3E") center/contain no-repeat
        }

        .social-icon:hover,
        .toggle-mode:hover {
            opacity: 1
        }

        main {
            flex: 1;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 40px 5%
        }

        h1 {
            font-size: clamp(28px, 5vw, 40px);
            margin: 0 0 30px;
            letter-spacing: -.015em
        }

        #drop-zone {
            width: 100%;
            max-width: 500px;
            height: 180px;
            border: 2px dashed var(--border-light);
            border-radius: 12px;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            margin-bottom: 20px
        }

        .dark-mode #drop-zone {
            border-color: var(--border-dark)
        }

        #drop-zone:hover {
            border-color: var(--accent);
            background-color: rgba(0, 113, 227, .05)
        }

        .icon-upload {
            width: 40px;
            height: 40px;
            display: block;
            -webkit-mask: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke-width='1.5' stroke='currentColor'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' d='M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5m-13.5-9L12 3m0 0l4.5 4.5M12 3v13.5'/%3E%3C/svg%3E") center/contain no-repeat;
            mask: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke-width='1.5' stroke='currentColor'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' d='M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5m-13.5-9L12 3m0 0l4.5 4.5M12 3v13.5'/%3E%3C/svg%3E") center/contain no-repeat;
            background-color: currentColor;
            margin-bottom: 15px;
            opacity: .7
        }

        #drop-zone p {
            margin: 0;
            max-width: 90%;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            padding: 0 10px
        }

        #file-input {
            display: none
        }

        .convert-btn {
            padding: 12px 30px;
            border-radius: 30px;
            background-color: var(--accent);
            color: #fff;
            border: none;
            margin: 20px 0;
            display: flex;
            align-items: center;
            gap: 8px
        }

        .changelog-changes,
        .changelog-date,
        .changelog-title,
        .changelog-version,
        .faq-answer,
        .faq-question,
        .faq-title,
        .feature-desc,
        .feature-title,
        .features-title {
            color: var(--text-light)
        }

        .convert-btn:hover {
            opacity: .85;
            box-shadow: 5px 15px 30px rgba(0, 122, 255, .5)
        }

        .icon-convert {
            width: 18px;
            height: 18px;
            display: block;
            -webkit-mask: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke-width='1.5' stroke='currentColor'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' d='M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12L12 16.5m0 0L7.5 12m4.5 4.5V3'/%3E%3C/svg%3E") center/contain no-repeat;
            mask: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke-width='1.5' stroke='currentColor'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' d='M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12L12 16.5m0 0L7.5 12m4.5 4.5V3'/%3E%3C/svg%3E") center/contain no-repeat;
            background-color: currentColor
        }

        .progress-container {
            width: 100%;
            max-width: 500px;
            height: 4px;
            background-color: rgba(0, 0, 0, .1);
            border-radius: 2px;
            margin: 20px 0;
            overflow: hidden;
            display: none
        }

        .dark-mode .progress-container {
            background-color: rgba(255, 255, 255, .1)
        }

        .progress-bar {
            height: 100%;
            width: 0;
            background-color: var(--accent);
            transition: width .3s
        }

        #output,
        .features-section {
            width: 100%;
            max-width: 800px
        }

        #output {
            max-height: 50vh;
            overflow: auto;
            text-align: left;
            padding: 15px;
            background-color: rgba(0, 0, 0, .03);
            border-radius: 8px;
            margin-top: 20px;
            white-space: pre-wrap;
            font-family: 'SF Mono', Menlo, monospace;
            display: none;
            font-size: clamp(12px, 2.5vw, 14px);
            line-height: 1.4
        }

        .dark-mode #output {
            background-color: rgba(255, 255, 255, .05)
        }

        .features-section {
            margin: 40px 0
        }

        .features-title {
            font-size: 24px;
            margin-bottom: 30px
        }

        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px
        }

        .feature-card {
            background: rgba(255, 255, 255, .05);
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 25px 20px;
            border-radius: 12px;
            transition: transform .3s;
            box-shadow: 0 10px 20px rgba(0, 0, 0, .05)
        }

        .dark-mode .feature-card {
            background-color: rgb(255 255 255 / 10%)
        }

        .feature-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, .1)
        }

        .feature-title {
            font-size: 18px;
            margin-bottom: 10px
        }

        .feature-desc {
            font-size: 15px;
            opacity: .8;
            margin: 0
        }

        .changelog-section,
        .faq-section {
            margin-top: 40px;
            max-width: 800px
        }

        .feature-icon {
            width: 40px;
            height: 40px;
            margin-bottom: 15px;
            background-color: var(--accent);
            -webkit-mask-size: contain;
            mask-size: contain;
            -webkit-mask-repeat: no-repeat;
            mask-repeat: no-repeat;
            -webkit-mask-position: center;
            mask-position: center
        }

        .changelog-section,
        footer {
            width: 100%
        }

        .dark-mode .feature-icon,
        .footer-divider {
            background-color: var(--border-light)
        }

        .icon-time {
            -webkit-mask-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke-width='1.5' stroke='currentColor'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' d='M12 6v6h4.5m4.5 0a9 9 0 11-18 0 9 9 0 0118 0z'/%3E%3C/svg%3E");
            mask-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke-width='1.5' stroke='currentColor'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' d='M12 6v6h4.5m4.5 0a9 9 0 11-18 0 9 9 0 0118 0z'/%3E%3C/svg%3E")
        }

        .icon-check {
            -webkit-mask-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke-width='1.5' stroke='currentColor'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' d='M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z'/%3E%3C/svg%3E");
            mask-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke-width='1.5' stroke='currentColor'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' d='M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z'/%3E%3C/svg%3E")
        }

        .icon-excel {
            -webkit-mask-image: url("data:image/svg+xml;utf8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 48 48'%3E%3Cpath d='M24.607 4.043c-.26-.009-.526.012-.793.064L8.617 7.146C6.523 7.566 5 9.423 5 11.559v24.883c0 2.135 1.523 3.993 3.617 4.412l15.197 3.039c1.944.389 3.742-.999 4.06-2.891H37.5c3.02 0 5.5-2.48 5.5-5.5V13.5c0-3.02-2.48-5.5-5.5-5.5H28V7.54c0-1.905-1.57-3.43-3.393-3.496zM24.402 7.05C24.742 6.981 25 7.192 25 7.54v32.922c0 .347-.259.558-.598.49L9.207 37.91A1.5 1.5 0 018 36.441V11.559c0-.725.495-1.329 1.207-1.471L24.402 7.05zM28 11h9.5c1.398 0 2.5 1.102 2.5 2.5v22c0 1.398-1.102 2.5-2.5 2.5H28V11zm3.5 4a1.5 1.5 0 100 3h4a1.5 1.5 0 100-3h-4zm-18.502 2.158a1.5 1.5 0 00-.846 2.305l2.988 4.695-2.988 4.695a1.5 1.5 0 002.072 2.07l2.234-3.512 2.234 3.51a1.5 1.5 0 002.073-2.07l-2.987-4.693 2.987-4.693a1.5 1.5 0 00-2.072-2.07L16.46 21.36l-2.235-3.512a1.5 1.5 0 00-1.227-.69zM31.5 23a1.5 1.5 0 100 3h4a1.5 1.5 0 100-3h-4zm0 8a1.5 1.5 0 100 3h4a1.5 1.5 0 100-3h-4z'/%3E%3C/svg%3E");
            mask-image: url("data:image/svg+xml;utf8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 48 48'%3E%3Cpath d='M24.607 4.043c-.26-.009-.526.012-.793.064L8.617 7.146C6.523 7.566 5 9.423 5 11.559v24.883c0 2.135 1.523 3.993 3.617 4.412l15.197 3.039c1.944.389 3.742-.999 4.06-2.891H37.5c3.02 0 5.5-2.48 5.5-5.5V13.5c0-3.02-2.48-5.5-5.5-5.5H28V7.54c0-1.905-1.57-3.43-3.393-3.496zM24.402 7.05C24.742 6.981 25 7.192 25 7.54v32.922c0 .347-.259.558-.598.49L9.207 37.91A1.5 1.5 0 018 36.441V11.559c0-.725.495-1.329 1.207-1.471L24.402 7.05zM28 11h9.5c1.398 0 2.5 1.102 2.5 2.5v22c0 1.398-1.102 2.5-2.5 2.5H28V11zm3.5 4a1.5 1.5 0 100 3h4a1.5 1.5 0 100-3h-4zm-18.502 2.158a1.5 1.5 0 00-.846 2.305l2.988 4.695-2.988 4.695a1.5 1.5 0 002.072 2.07l2.234-3.512 2.234 3.51a1.5 1.5 0 002.073-2.07l-2.987-4.693 2.987-4.693a1.5 1.5 0 00-2.072-2.07L16.46 21.36l-2.235-3.512a1.5 1.5 0 00-1.227-.69zM31.5 23a1.5 1.5 0 100 3h4a1.5 1.5 0 100-3h-4zm0 8a1.5 1.5 0 100 3h4a1.5 1.5 0 100-3h-4z'/%3E%3C/svg%3E")
        }

        .icon-lock {
            -webkit-mask-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke-width='1.5' stroke='currentColor'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' d='M16.5 10.5V6.75a4.5 4.5 0 10-9 0v3.75m-.75 11.25h10.5a2.25 2.25 0 002.25-2.25v-6.75a2.25 2.25 0 00-2.25-2.25H6.75a2.25 2.25 0 00-2.25 2.25v6.75a2.25 2.25 0 002.25 2.25z'/%3E%3C/svg%3E");
            mask-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke-width='1.5' stroke='currentColor'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' d='M16.5 10.5V6.75a4.5 4.5 0 10-9 0v3.75m-.75 11.25h10.5a2.25 2.25 0 002.25-2.25v-6.75a2.25 2.25 0 00-2.25-2.25H6.75a2.25 2.25 0 00-2.25 2.25v6.75a2.25 2.25 0 002.25 2.25z'/%3E%3C/svg%3E")
        }

        .faq-section {
            width: 100%;
            text-align: left
        }

        .faq-title {
            font-size: 20px;
            margin-bottom: 20px
        }

        .faq-item {
            margin-bottom: 20px;
            border-bottom: 1px solid var(--border-light);
            padding-bottom: 20px
        }

        .dark-mode .changelog-item,
        .dark-mode .faq-item {
            border-bottom-color: var(--border-dark)
        }

        .faq-question {
            margin-bottom: 8px;
            font-size: 16px
        }

        .faq-answer {
            font-size: 14px;
            opacity: .8
        }

        .changelog-title {
            font-size: 22px;
            font-weight: 600;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--border-light)
        }

        .dark-mode .changelog-title {
            color: var(--text-dark);
            border-bottom-color: var(--border-dark)
        }

        .changelog-list {
            display: flex;
            flex-direction: column;
            gap: 0
        }

        .changelog-item {
            padding: 16px 0;
            border-bottom: 1px solid var(--border-light)
        }

        .changelog-item:last-child {
            border-bottom: none
        }

        .changelog-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 6px
        }

        .changelog-version {
            font-size: 17px;
            font-weight: 500
        }

        .dark-mode .changelog-changes li::before,
        .dark-mode .changelog-version {
            color: var(--border-light)
        }

        .changelog-date {
            font-size: 13px;
            opacity: .5
        }

        .changelog-changes {
            font-size: 15px;
            line-height: 1.4
        }

        .footer-link:hover,
        .footer-logo {
            color: var(--accent)
        }

        .changelog-changes ul {
            padding-left: 20px;
            margin: 8px 0 0
        }

        .changelog-changes li {
            margin-bottom: 4px;
            position: relative;
            list-style-type: none
        }

        .changelog-changes li::before {
            content: "•";
            position: absolute;
            left: -15px;
            color: var(--text-light)
        }

        footer {
            padding: 30px 0;
            background-color: rgba(0, 122, 255, .05);
            margin-top: 60px
        }

        .footer-content {
            max-width: 800px;
            margin: 0 auto;
            display: flex;
            flex-direction: column;
            align-items: center
        }

        .footer-logo {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 15px
        }

        .footer-links {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
            flex-wrap: wrap;
            justify-content: center
        }

        .footer-link {
            color: var(--text-light);
            text-decoration: none;
            font-size: 14px;
            transition: color .3s
        }

        .footer-divider {
            width: 1px;
            height: 14px
        }

        .dark-mode .footer-divider {
            background-color: var(--border-dark)
        }

        .footer-copyright {
            font-size: 13px;
            color: var(--text-light);
            opacity: .7;
            margin-top: 15px
        }

        .footer-social {
            display: flex;
            gap: 15px;
            margin-top: 20px
        }

        .social-icon {
            width: 20px;
            height: 20px;
            opacity: .7;
            transition: opacity .3s;
            background-color: var(--text-light);
            -webkit-mask-size: contain;
            mask-size: contain;
            -webkit-mask-repeat: no-repeat;
            mask-repeat: no-repeat;
            -webkit-mask-position: center;
            mask-position: center
        }

        .dark-mode .social-icon {
            background-color: var(--text-dark)
        }

        .icon-twitter {
            -webkit-mask-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='currentColor'%3E%3Cpath d='M8.29 20.251c7.547 0 11.675-6.253 11.675-11.675 0-.178 0-.355-.012-.53A8.348 8.348 0 0022 5.92a8.19 8.19 0 01-2.357.646 4.118 4.118 0 001.804-2.27 8.224 8.224 0 01-2.605.996 4.107 4.107 0 00-6.993 3.743 11.65 11.65 0 01-8.457-4.287 4.106 4.106 0 001.27 5.477A4.072 4.072 0 012.8 9.713v.052a4.105 4.105 0 003.292 4.022 4.095 4.095 0 01-1.853.07 4.108 4.108 0 003.834 2.85A8.233 8.233 0 012 18.407a11.616 11.616 0 006.29 1.84'/%3E%3C/svg%3E");
            mask-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='currentColor'%3E%3Cpath d='M8.29 20.251c7.547 0 11.675-6.253 11.675-11.675 0-.178 0-.355-.012-.53A8.348 8.348 0 0022 5.92a8.19 8.19 0 01-2.357.646 4.118 4.118 0 001.804-2.27 8.224 8.224 0 01-2.605.996 4.107 4.107 0 00-6.993 3.743 11.65 11.65 0 01-8.457-4.287 4.106 4.106 0 001.27 5.477A4.072 4.072 0 012.8 9.713v.052a4.105 4.105 0 003.292 4.022 4.095 4.095 0 01-1.853.07 4.108 4.108 0 003.834 2.85A8.233 8.233 0 012 18.407a11.616 11.616 0 006.29 1.84'/%3E%3C/svg%3E")
        }

        .icon-github {
            -webkit-mask-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='currentColor'%3E%3Cpath fill-rule='evenodd' d='M12 2C6.477 2 2 6.484 2 12.017c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483 0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.202 2.398.1 2.651.64.7 1.028 1.595 1.028 2.688 0 3.848-2.339 4.695-4.566 4.943.359.309.678.92.678 1.855 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.482A10.019 10.019 0 0022 12.017C22 6.484 17.522 2 12 2z' clip-rule='evenodd'/%3E%3C/svg%3E");
            mask-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='currentColor'%3E%3Cpath fill-rule='evenodd' d='M12 2C6.477 2 2 6.484 2 12.017c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483 0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.202 2.398.1 2.651.64.7 1.028 1.595 1.028 2.688 0 3.848-2.339 4.695-4.566 4.943.359.309.678.92.678 1.855 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.482A10.019 10.019 0 0022 12.017C22 6.484 17.522 2 12 2z' clip-rule='evenodd'/%3E%3C/svg%3E")
        }

        .icon-mail {
            -webkit-mask-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='currentColor'%3E%3Cpath d='M1.5 8.67v8.58a3 3 0 003 3h15a3 3 0 003-3V8.67l-8.928 5.493a3 3 0 01-3.144 0L1.5 8.67z'/%3E%3Cpath d='M22.5 6.908V6.75a3 3 0 00-3-3h-15a3 3 0 00-3 3v.158l9.714 5.978a1.5 1.5 0 001.572 0L22.5 6.908z'/%3E%3C/svg%3E");
            mask-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='currentColor'%3E%3Cpath d='M1.5 8.67v8.58a3 3 0 003 3h15a3 3 0 003-3V8.67l-8.928 5.493a3 3 0 01-3.144 0L1.5 8.67z'/%3E%3Cpath d='M22.5 6.908V6.75a3 3 0 00-3-3h-15a3 3 0 00-3 3v.158l9.714 5.978a1.5 1.5 0 001.572 0L22.5 6.908z'/%3E%3C/svg%3E")
        }

        @media (max-width:600px) {
            .features-grid {
                grid-template-columns: 1fr
            }

            .feature-card {
                padding: 20px
            }

            .changelog-item {
                padding: 14px 0
            }

            .changelog-version {
                font-size: 16px
            }

            .changelog-changes {
                font-size: 14px
            }

            footer {
                padding: 25px 0
            }

            .footer-links {
                gap: 12px
            }

            .footer-divider {
                display: none
            }

            main {
                padding: 30px 15px
            }

            #output {
                margin: 20px 15px 0;
                max-height: 50vh;
                padding: 7px;
                font-size: 12px
            }

            #drop-zone {
                height: 150px
            }

            .update-banner {
                font-size: 12px;
                padding: 6px
            }

            .faq-section {
                margin-top: 30px
            }

            .faq-title {
                font-size: 18px
            }
        }

        .update-banner a {
            text-decoration: none;
            font-weight: 900
        }
    </style>
</head>

<body>
    <div class="update-banner"><a href="#v0">Update: Please Chaek Latest Version - v1.3.0</a></div>
    <header>
        <div class="logo">EcrMaker</div>
        <button class="toggle-mode" aria-label="Toggle dark mode"></button>
    </header>

    <main>
        <div id="drop-zone">
            <i class="icon-upload"></i>
            <p>Drag & drop Excel file here or click to browse</p>
        </div>
        <input type="file" id="file-input" accept=".xlsx, .xls">

        <button class="convert-btn" onclick="convertToText()">
            <i class="icon-convert"></i> Convert to TXT
        </button>

        <div class="progress-container">
            <div class="progress-bar"></div>
        </div>

        <pre id="output"></pre>

        <!-- New Key Features Section -->
        <div class="features-section">
            <h2 class="features-title">Key Features</h2>

            <div class="features-grid">
                <div class="feature-card">
                    <div class="feature-icon icon-time"></div>
                    <h3 class="feature-title">Time-Saving</h3>
                    <p class="feature-desc">Generate ECR text files in seconds, saving hours of manual work</p>
                </div>

                <div class="feature-card">
                    <div class="feature-icon icon-check"></div>
                    <h3 class="feature-title">Error-Free</h3>
                    <p class="feature-desc">Eliminate manual errors with our automated conversion system</p>
                </div>

                <div class="feature-card">
                    <div class="feature-icon icon-excel"></div>
                    <h3 class="feature-title">Excel Compatible</h3>
                    <p class="feature-desc">Works with your existing Excel data for seamless integration</p>
                </div>

                <div class="feature-card">
                    <div class="feature-icon icon-lock"></div>
                    <h3 class="feature-title">Secure Processing</h3>
                    <p class="feature-desc">Your data never leaves your browser – complete privacy guaranteed</p>
                </div>
            </div>
        </div>

        <div class="faq-section">
            <h2 class="faq-title">Frequently Asked Questions</h2>

            <div class="faq-item">
                <div class="faq-question">What file formats are supported?</div>
                <div class="faq-answer">We support both .xlsx and .xls Excel file formats. The converted file will be
                    downloaded as a .txt file.</div>
            </div>

            <div class="faq-item">
                <div class="faq-question">How is my data processed?</div>
                <div class="faq-answer">All processing happens in your browser. Your files are never uploaded to any
                    server, ensuring complete privacy.</div>
            </div>

            <div class="faq-item">
                <div class="faq-question">What calculations are performed?</div>
                <div class="faq-answer">The converter calculates values for columns 7-9 based on column 6 (12% of col6
                    for col7, 8.33% of col6 for col8, and the difference for col9).</div>
            </div>

            <div class="faq-item">
                <div class="faq-question">Why are my numbers rounded?</div>
                <div class="faq-answer">All numeric values are rounded to the nearest whole number for consistency in
                    the output format.</div>
            </div>

            <div class="faq-item">
                <div class="faq-question">Can I convert multiple files at once?</div>
                <div class="faq-answer">Currently, the tool processes one file at a time for optimal performance and
                    clarity.</div>
            </div>
        </div>

        <!-- Enhanced Changelog Section -->
        <div class="changelog-section" id="v0">
            <h2 class="changelog-title">Changelog</h2>

            <div class="changelog-list">
                <div class="changelog-item">
                    <div class="changelog-header">
                        <div class="changelog-version">v1.3.0</div>
                        <div class="changelog-date">May 11, 2025</div>
                    </div>
                    <div class="changelog-changes">
                        <ul>
                            <li>Now the first row in Excel will be automatically removed.</li>
                            <li>Now output filename auto get new filename + A-z random text</li>
                            <li>New updates coming to the footer section</li>
                        </ul>
                    </div>
                </div>
                <div class="changelog-item">
                    <div class="changelog-header">
                        <div class="changelog-version">v1.2.0</div>
                        <div class="changelog-date">May 10, 2025</div>
                    </div>
                    <div class="changelog-changes">
                        <ul>
                            <li>Redesigned progress bar animation</li>
                            <li>Faster conversion (2s instead of 5s)</li>
                            <li>Added immediate visual feedback</li>
                            <li>Fixed dark mode persistence</li>
                        </ul>
                    </div>
                </div>

                <div class="changelog-item">
                    <div class="changelog-header">
                        <div class="changelog-version">v1.1.0</div>
                        <div class="changelog-date">May 2, 2025</div>
                    </div>
                    <div class="changelog-changes">
                        <ul>
                            <li>Added dark mode support</li>
                            <li>Improved mobile layout</li>
                            <li>File name display after selection</li>
                            <li>Fixed rounding calculations</li>
                        </ul>
                    </div>
                </div>

                <div class="changelog-item">
                    <div class="changelog-header">
                        <div class="changelog-version">v1.0.0</div>
                        <div class="changelog-date">April 1, 2025</div>
                    </div>
                    <div class="changelog-changes">
                        <ul>
                            <li>Initial release</li>
                            <li>Excel to TXT conversion</li>
                            <li>Automatic calculations</li>
                            <li>Drag and drop support</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <footer>
        <div class="footer-content">
            <div class="footer-logo">EcrMaker</div>

            <!-- <div class="footer-links">
                <a href="about.html" class="footer-link">About</a>
                <div class="footer-divider"></div>
                <a href="#" class="footer-link">Privacy Policy</a>
                <div class="footer-divider"></div>
                <a href="#" class="footer-link">Terms of Service</a>
            </div>

            <div class="footer-social">
                <a href="#" class="social-icon icon-twitter" aria-label="Twitter"></a>
                <a href="#" class="social-icon icon-github" aria-label="GitHub"></a>
                <a href="#" class="social-icon icon-mail" aria-label="Email"></a>
            </div> -->

            <div class="footer-copyright">
                &copy; <span id="year"></span> EcrMaker. All rights reserved.
            </div>
        </div>
    </footer>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script>
        // Dark mode toggle - default to light mode
        const toggleBtn = document.querySelector('.toggle-mode');
        const body = document.body;

        // Only enable dark mode if previously selected by user
        if (localStorage.getItem('darkMode') === 'enabled') {
            body.classList.add('dark-mode');
        }

        toggleBtn.addEventListener('click', () => {
            body.classList.toggle('dark-mode');
            localStorage.setItem('darkMode', body.classList.contains('dark-mode') ? 'enabled' : '');
        });

        // File conversion functionality
        const dropZone = document.getElementById('drop-zone');
        const fileInput = document.getElementById('file-input');
        const progressBarContainer = document.querySelector('.progress-container');
        const progressBar = document.querySelector('.progress-bar');
        let selectedFile = null;

        dropZone.addEventListener('dragover', (e) => {
            e.preventDefault();
            dropZone.style.borderColor = "var(--accent)";
            dropZone.style.backgroundColor = "rgba(0, 113, 227, 0.1)";
        });

        dropZone.addEventListener('dragleave', () => {
            dropZone.style.borderColor = "";
            dropZone.style.backgroundColor = "";
        });

        dropZone.addEventListener('drop', (e) => {
            e.preventDefault();
            if (e.dataTransfer.files.length) {
                handleFileSelection(e.dataTransfer.files[0]);
            }
            dropZone.style.borderColor = "";
            dropZone.style.backgroundColor = "";
        });

        dropZone.addEventListener('click', () => fileInput.click());

        fileInput.addEventListener('change', (e) => {
            if (e.target.files.length) {
                handleFileSelection(e.target.files[0]);
            }
        });

        function handleFileSelection(file) {
            if (!file.name.endsWith('.xlsx') && !file.name.endsWith('.xls')) {
                alert("Please select an Excel file (.xlsx or .xls)");
                return;
            }
            selectedFile = file;
            dropZone.innerHTML = `<i class="icon-upload"></i><p>Selected: ${file.name}</p>`;
        }

        function convertToText() {
            if (!selectedFile) {
                alert("Please select an Excel file first.");
                return;
            }

            // Immediately show progress and jump to 5%
            progressBarContainer.style.display = 'block';
            progressBar.style.transition = 'none';
            progressBar.style.width = '5%';

            // Force reflow to apply immediate change
            void progressBar.offsetWidth;

            // Now animate smoothly to 100%
            progressBar.style.transition = 'width 1.5s linear';
            progressBar.style.width = '100%';

            // When complete
            setTimeout(() => {
                progressBarContainer.style.display = 'none';
                processFile();

                // Reset for next use
                progressBar.style.transition = 'none';
                progressBar.style.width = '0%';
            }, 2000);
        }

        function processFile() {
            const reader = new FileReader();
            reader.onload = function (e) {
                const workbook = XLSX.read(e.target.result, { type: 'binary' });
                const sheet = workbook.Sheets[workbook.SheetNames[0]];
                const jsonData = XLSX.utils.sheet_to_json(sheet, { header: 1 });

                // Remove the first row (header row)
                if (jsonData.length > 0) {
                    jsonData.shift(); // This removes the first element from the array
                }

                let textContent = jsonData.map(row => {
                    let newRow = [...row];

                    let col6 = parseFloat(row[5]) || 0;
                    let col7 = Math.round(col6 * 0.12);
                    let col8 = Math.round(col6 * 0.0833);
                    let col9 = col7 - col8;

                    newRow[6] = col7;
                    newRow[7] = col8;
                    newRow[8] = col9;

                    return newRow.map(cell => (typeof cell === 'number' ? cell.toFixed(0) : cell)).join('#~#');
                }).join('\n');

                const output = document.getElementById('output');
                output.textContent = textContent;
                output.style.display = 'block';
                downloadTXT(selectedFile, textContent);
            };
            reader.readAsBinaryString(selectedFile);
        }

        function randStr(len) {
            return Array.from({ length: len }, () => 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz'.charAt(Math.floor(Math.random() * 52))).join('');
        }

        function downloadTXT(file, content) {
            const fileName = file.name.replace(/\.[^/.]+$/, '') + randStr(1) + '.txt';
            const blob = new Blob([content], { type: 'text/plain' });
            const a = document.createElement('a');
            a.href = URL.createObjectURL(blob);
            a.download = fileName;
            a.click();
            URL.revokeObjectURL(a.href);
        }

        const d = new Date();
        let year = d.getFullYear();
        document.getElementById("year").innerHTML = year;

          setTimeout(function () {
             window.location.href = "maintenance.html"; // Replace with your target URL
          }, 2000); // 2000 milliseconds = 2 seconds
    </script>
</body>

</html>
